using Machine.Specifications;

namespace GeocachingToolbox.UnitTests.GeocachingCom
{
    [Subject("Extract view states from cache page")]
    public class ExtractViewstatesFromPage
    {
        private static string[] m_Viewstates;
        private static string[] m_expectedViewstates;

        private Establish context = () =>
        {
            m_expectedViewstates = new string[2];
            m_expectedViewstates[0] =
                "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";
            m_expectedViewstates[1] =
                "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";
        };

        private Because of = () =>
        {
            var page = MspecExtensionMethods.ReadContent(@"GeocachingCom\WebpageContents\GC3RMAT\GC3RMAT.html");
            m_Viewstates = HtmlUtils.ExtractViewstates(page);
        };

        private It should_return_an_object_with_viewstates = () =>
            m_Viewstates.ShouldContainOnly(m_expectedViewstates);
    }
}